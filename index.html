<button id="triggerButton">Trigger WebUSB</button>

<div id="target"></div>

<script>
    document.getElementById('triggerButton').addEventListener('click', function () {
        if (navigator.usb) {
            talkToDevice();
        } else {
            alert('WebUSB not supported.');
        }
    });

    async function talkToDevice() {


        try {

            // Prompt user to choose device
            let device = await navigator.usb.requestDevice({ filters: [{ vendorId: 0x0451 }] });

            console.log(device);
            // Product Name
            console.log("Product Name: " + device.productName);
            // Manufacturer Name
            console.log("Manufacturer: " + device.manufacturerName);

            await device.open(); // Begin a session.
            await device.selectConfiguration(1); // Select configuration #1 for the device.
            console.log(device);
            await device.claimInterface(0); // Request exclusive control over interface #2.


            // Ready to receive data
            // let result = device.transferIn(5, 64); // Waiting for 64 bytes of data from endpoint #5.
            // let decoder = new TextDecoder();
            // document.getElementById('target').innerHTML = 'Received: ' + decoder.decode(result.data);

        } catch (error) {
            document.getElementById('target').innerHTML = error;
        }
    }
</script>
